<head>
    <!-- Utilisation du thème Minty de Bootswatch pour un design cohérent -->
    <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.2/minty/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
</head>

@model UserProfileViewModel

@{
    ViewData["Title"] = "Mon Profil";
}

<!-- Titre de la page -->
<h2 class="text-center text-primary mt-5">Mon Profil</h2>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <!-- Card principale pour les informations personnelles -->
            <div class="card shadow-lg rounded-4 mb-4">
                <div class="card-body">
                    <h4 class="card-title text-center mb-4 text-primary">Informations Personnelles</h4>

                    <!-- Formulaire de modification -->
                    <form asp-action="Edit" method="post">
                        <div class="form-group">
                            <label for="FirstName">Prénom</label>
                            <input type="text" class="form-control form-control-lg" id="FirstName" name="FirstName" value="@Model.User.FirstName" required />
                        </div>

                        <div class="form-group">
                            <label for="LastName">Nom</label>
                            <input type="text" class="form-control form-control-lg" id="LastName" name="LastName" value="@Model.User.LastName" required />
                        </div>

                        <div class="form-group">
                            <label for="Email">Email</label>
                            <input type="email" class="form-control form-control-lg" id="Email" name="Email" value="@Model.User.Email" readonly />
                        </div>

                        <div class="form-group">
                            <label for="Password">Mot de passe</label>
                            <input type="password" class="form-control form-control-lg" id="Password" name="Password" placeholder="Laisser vide pour ne pas modifier" />
                        </div>

                        <button type="submit" class="btn btn-primary btn-lg btn-block">Enregistrer les Modifications</button>
                    </form>
                </div>
            </div>

            <!-- Section Historique des Commandes -->
            <div>
                <h4 class="text-center text-primary">Historique des Commandes</h4>

                @if (Model.OrderHistorys != null && Model.OrderHistorys.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover mt-4">
                            <thead class="thead-light">
                                <tr>
                                    <th>Date</th>
                                    <th>Numéro de Commande</th>
                                    <th>Status</th>
                                    <th>Total (€)</th>
                                    <th>Lieu de Livraison</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var order in Model.OrderHistorys)
                                {
                                    <tr>
                                        <td>@order.OrderDate.ToString("dd/MM/yyyy")</td>
                                        <td>@order.OrderNumber</td>
                                        <td>@order.Status</td>
                                        <td>
                                            @(
                                                order.CartItems != null && order.CartItems.Any() ?
                                                order.CartItems.Sum(ci => ci.Quantity * (ci.Product?.Price ?? 0)) : 0
                                                ) €
                                        </td>
                                        <td>@order.ShippingAddress</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <p class="text-center text-muted">Vous n'avez pas encore passé de commandes.</p>
                }
            </div>
        </div>
    </div>
</div>

<!-- Styles personnalisés -->
<style>
    body {
        font-family: 'Poppins', sans-serif;
        background-color: #f7f7f7;
    }

    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 2rem;
    }

    .card {
        border-radius: 10px;
        border: none;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .card-body {
        padding: 2rem;
    }

    .form-group label {
        font-weight: 600;
    }

    .form-control {
        border-radius: 8px;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
        font-size: 1.1rem;
    }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

    .btn-block {
        padding: 15px;
    }

    .table {
        font-size: 0.9rem;
    }

        .table th, .table td {
            padding: 1rem;
            text-align: center;
        }

        .table th {
            background-color: #007bff;
            color: white;
        }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f9f9f9;
    }

    .table-bordered {
        border: 1px solid #ddd;
    }

    .table-hover tbody tr:hover {
        background-color: #e9ecef;
    }

    h2, h4 {
        font-weight: 600;
    }

    .mt-5 {
        margin-top: 3rem;
    }

    .mt-4 {
        margin-top: 2rem;
    }
</style>
